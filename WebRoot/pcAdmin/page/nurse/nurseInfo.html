<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>系统基本参数--layui后台管理模板</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="../../layui/css/layui.css" media="all" />
	<link rel="stylesheet" href="../../css/font_eolqem241z66flxr.css" media="all" />
	<style type="text/css">
		.layui-table td, .layui-table th{ text-align: center; }
		.layui-table td{ padding:5px; }
	</style>
</head>
<body class="childrenBody">
	<form class="layui-form">
		<table class="layui-table">
		    <tbody>
		    	<tr>
		    		<td width="15%">编号</td>
		    		<td width="35%"><input type="text" id="userid" class="layui-input" value="" ></td>
		    		<td width="15%">昵称</td>
		    		<td width="35%"><input type="text" id="nickname" class="layui-input"></td>
		    	</tr>

				<tr>
		    		<td width="15%">openId</td>
		    		<td width="35%"><input type="text" id="openid" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">用户手机号码</td>
		    		<td width="35%"><input type="text" id="telephone" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">国家</td>
		    		<td width="35%"><input type="text" id="country" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">省份</td>
		    		<td width="35%"><input type="text" id="province" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">城市</td>
		    		<td width="35%"><input type="text" id="city" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">性别</td>
		    		<td width="35%"><input type="text" id="sex" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">出生日期</td>
		    		<td width="35%"><input type="text" id="birthday" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">年龄</td>
		    		<td width="35%"><input type="text" id="blood" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">用户类型</td>
		    		<td width="35%"><input type="text" id="usertype" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">是否通过验证</td>
		    		<td width="35%"><input type="text" id="userverify" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工真实姓名</td>
		    		<td width="35%"><input type="text" id="nurserealname" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">护工身份证号码</td>
		    		<td width="35%"><input type="text" id="idcardno" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工所在地址</td>
		    		<td width="35%"><input type="text" id="adress" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">护工详细地址</td>
		    		<td width="35%"><input type="text" id="adressdetail" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工婚否</td>
		    		<td width="35%"><input type="text" id="marriage" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">护工身高</td>
		    		<td width="35%"><input type="text" id="height" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工体重</td>
		    		<td width="35%"><input type="text" id="weight" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">护工血型</td>
		    		<td width="35%"><input type="text" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工名族</td>
		    		<td width="35%"><input type="text" id="nation" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">护工文化程度</td>
		    		<td width="35%"><input type="text" id="education" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工工作经验</td>
		    		<td width="35%"><input type="text" id="experience" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">服务项目</td>
		    		<td width="35%"><input type="text" id="" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">服务区域</td>
		    		<td width="35%"><input type="text" id="areaListString" class="layui-input " lay-verify="required" ></td>
		    		<td width="15%">服务项目</td>
		    		<td width="35%"><input type="text" id="contentListString" class="layui-input " lay-verify="required" ></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">护工擅长</td>
		    		<td width="35%"><textarea placeholder="请输入网站描述" class="layui-textarea description"></textarea></td>
		    		<td width="15%">自我简介</td>
		    		<td width="35%"><textarea placeholder="请输入网站描述" class="layui-textarea description"></textarea></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">头像</td>
		    		<td width="35%"><img id="usericon" width="80%" src="" /></td>
		    		<td width="15%">工作证书</td>
		    		<td width="35%"><img id="papers" width="80%" src="" /></td>
		    	</tr>
		    	<tr>
		    		<td width="15%">身份证正面照</td>
		    		<td width="35%"><img id="face" width="80%" src="" />
		    		<div style="padding:20px 0px;">
		    			<span class="layui-btn layui-btn-normal validateIdCard" side="face">正面验证</span>
		    			<span class="layui-btn layui-btn-warm validateIdCard" side="back">反面验证</span>
		    		</div>
		    		</td>
		    		<td width="15%">身份证反面照</td>
		    		<td width="35%"><img id="opposite" width="80%" src="" />
		    		<div style="padding:20px 0px;">
		    			<span class="layui-btn layui-btn-normal validateIdCard" side="face">正面验证</span>
		    			<span class="layui-btn layui-btn-warm validateIdCard" side="back">反面验证</span>
		    		</div>
		    		</td>
		    	</tr>
		    		<td colspan="4">
		    			<button class="layui-btn layui-btn-normal" id="sureNurse" face="0" back="0" style="display:none;">验证成功</button>
		    		</td>
		    	<tr>
		    	</tr>
		    </tbody>
		</table>
		<!--
		<div class="layui-form-item" style="text-align: right;">
			<div class="layui-input-block">
				<button class="layui-btn" lay-submit="" lay-filter="systemParameter">立即提交</button>
				<button type="reset" class="layui-btn layui-btn-primary">重置</button>
		    </div>
		</div>
		-->
	</form>
	<script type="text/javascript" src="../../js/jquery.min.js"></script>
	<script type="text/javascript" src="../../layui/layui.js"></script>
<script>
function getUrlParam(name) {
	var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
	var r = window.location.search.substr(1).match(reg);
	if (r != null) return unescape(r[2]);
	return null;
}
	initView();
	function initView(){
		var userid=getUrlParam("userid");
		$("#userid").val(userid);
	 	$.ajax({  
	 		url:"http://127.0.0.1:8080/erlaila/pcnurse/selectNurseDetailById.action",  
			type:"get",  
			dataType:"",  
			data:"userid="+userid,  
			success:function(response){
				$("#nickname").val(response.user.nickname);
				$("#openid").val(response.user.openid);
				$("#telephone").val(response.user.telephone);
				$("#country").val(response.user.country);
				$("#province").val(response.user.province);
				$("#city").val(response.user.city);
				$("#sex").val(response.user.sex);
				$("#birthday").val(response.user.birthday);
				$("#usertype").val(response.user.usertype);
				$("#userverify").val(response.user.userverify);
				$("#nurserealname").val(response.nursedetail.nurserealname);
				$("#idcardno").val(response.nursedetail.idcardno);
				$("#adress").val(response.nursedetail.adress);
				$("#adressdetail").val(response.nursedetail.adressdetail);
				$("#marriage").val(response.nursedetail.marriage);
				$("#height").val(response.nursedetail.height);
				$("#blood").val(response.nursedetail.blood);				
				$("#weight").val(response.nursedetail.weight);
				$("#nation").val(response.nursedetail.nation);
				$("#education").val(response.nursedetail.education);
				$("#experience").val(response.nursedetail.experience);
				$("#education").val(response.nursedetail.education);
				$("#usericon").attr("src",response.user.usericon);
				$("#papers").attr("src",response.realNameAuthentication.papers);
				$("#face").attr("src",response.realNameAuthentication.face);
				$("#opposite").attr("src",response.realNameAuthentication.opposite); 
				var nurseContentStr=response.contentListString;
				var nurseArea=response.areaListString;
				$("#contentListString").val(nurseContentStr);
				$("#areaListString").val(nurseArea);
			},  
			error:function(){
						  
			}  
		});
	}	
	//提交验证
	$(".validateIdCard").click(function(){
		var userId=$("#userid").val();
  		var side=$(this).attr("side");
  		var imgSrc=$(this).parents("td").find("img").attr("src");
  		var sear=new RegExp('pic/');
　　		if(sear.test(imgSrc)){
    　			var arr = imgSrc.split("pic/");
    		var pathString=arr[1];
    		$.ajax({  
	 			url:"http://127.0.0.1:8080/erlaila/pcnurse/validateIdCardByPho.action",  
				type:"get",  
				dataType:"",  
				data:"side="+side+"&pathString="+pathString+"&userid="+userId,  
				success:function(response){
					alert("response:"+response);
					if(response=="true"){
						if(side=="face"){
							$("#sureNurse").attr("face","1");
						}else{
							$("#sureNurse").attr("back","1");
						}
						var backFg=$("#sureNurse").attr("back");
						var faceFg=$("#sureNurse").attr("face");
						if(backFg=="1"){
							if(faceFg=="1"){
								$("#sureNurse").css("display","block");
							}		
						}	
					}
				},  
				error:function(){
						  
				}  
			});
　　		}else{
			alert("发生错误,请与管理员联系！！！！");
		}	
	});	
	
	//成为护工
	$("#sureNurse").click(function(){
		$.ajax({  
	 		url:"http://127.0.0.1:8080/erlaila/pcnurse/changeUserType.action",  
			type:"get",  
			dataType:"",  
			data:"userid="+userId,  
			success:function(response){
				
			}, 
			error:function(){
						  
			}  
		});
	});
</script>
</body>
</html>